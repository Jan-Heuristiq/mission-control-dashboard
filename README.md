
# Mission Control Dashboard

This is a dashboard for company founders to track collective and individual progress towards a total revenue goal. It's designed to foster team success and private accountability, built with React, Supabase, and Tailwind CSS.

This application is deployed using a modern, reliable workflow. This guide will walk you through the process step-by-step.

---

## Deployment Guide (10-15 minutes)

We will use three free services to get your app live. You will not need to write any code.

1.  **Supabase:** Our simple, powerful database.
2.  **GitHub:** Where we'll store the app's code.
3.  **Vercel:** Our hosting service that will build and publish the app.

### Step 1: Set Up Your Supabase Database

1.  **Create a Supabase Account:** Go to [supabase.com](https://supabase.com) and sign up for a free account.

2.  **Create a New Project:**
    *   On your dashboard, click **"New project"**.
    *   Give it a name (e.g., `mission-control-db`).
    *   Create and save a strong **Database Password**.
    *   Choose a **Region** close to you.
    *   Click **"Create new project"**.

3.  **Run the Setup Script:**
    *   Once the project is ready, go to the **"SQL Editor"** in the left menu.
    *   Click **"+ New query"**.
    *   Copy the entire SQL script below and paste it into the editor.

    ```sql
    -- Create founders table with a column for their private access key
    CREATE TABLE founders (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      name TEXT NOT NULL,
      target INT NOT NULL,
      access_key TEXT NOT NULL
    );

    -- Create revenue table
    CREATE TABLE revenue (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      founder_id BIGINT REFERENCES founders(id) ON DELETE CASCADE,
      amount INT NOT NULL,
      description TEXT,
      date DATE NOT NULL,
      source TEXT NOT NULL DEFAULT 'Heuristiq', -- 'Heuristiq' or 'Echodeck'
      is_new_customer BOOLEAN NOT NULL DEFAULT false
    );

    -- Create posts table
    CREATE TABLE posts (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      author_id BIGINT REFERENCES founders(id) ON DELETE CASCADE,
      text TEXT NOT NULL,
      type TEXT NOT NULL, -- 'win' or 'blocker'
      timestamp TIMESTAMPTZ DEFAULT NOW() NOT NULL
    );

    -- Create config table for app settings
    CREATE TABLE config (
      key TEXT PRIMARY KEY,
      value TEXT
    );
    
    -- Secondary Missions for non-revenue goals
    CREATE TABLE secondary_missions (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      name TEXT NOT NULL,
      description TEXT NOT NULL,
      target_arr INT NOT NULL,
      target_customers INT NOT NULL
    );

    CREATE TABLE founder_secondary_missions (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      founder_id BIGINT REFERENCES founders(id) ON DELETE CASCADE,
      mission_id BIGINT REFERENCES secondary_missions(id) ON DELETE CASCADE,
      share_percentage INT NOT NULL,
      UNIQUE(mission_id, founder_id) -- Ensures each founder has only one share per mission
    );

    -- Enable Row Level Security (good practice)
    ALTER TABLE founders ENABLE ROW LEVEL SECURITY;
    ALTER TABLE revenue ENABLE ROW LEVEL SECURITY;
    ALTER TABLE posts ENABLE ROW LEVEL SECURITY;
    ALTER TABLE config ENABLE ROW LEVEL SECURITY;
    ALTER TABLE secondary_missions ENABLE ROW LEVEL SECURITY;
    ALTER TABLE founder_secondary_missions ENABLE ROW LEVEL SECURITY;

    -- Create policies to allow your app to read/write data
    CREATE POLICY "Allow public read access" ON founders FOR SELECT USING (true);
    CREATE POLICY "Allow public read access" ON revenue FOR SELECT USING (true);
    CREATE POLICY "Allow public read access" ON posts FOR SELECT USING (true);
    CREATE POLICY "Allow public read access" ON config FOR SELECT USING (true);
    CREATE POLICY "Allow insert for anyone" ON revenue FOR INSERT WITH CHECK (true);
    CREATE POLICY "Allow insert for anyone" ON posts FOR INSERT WITH CHECK (true);
    CREATE POLICY "Allow update for anyone" ON revenue FOR UPDATE USING (true);
    CREATE POLICY "Allow update for anyone" ON posts FOR UPDATE USING (true);
    CREATE POLICY "Allow delete for anyone" ON revenue FOR DELETE USING (true);
    CREATE POLICY "Allow delete for anyone" ON posts FOR DELETE USING (true);
    CREATE POLICY "Allow public read access" ON secondary_missions FOR SELECT USING (true);
    CREATE POLICY "Allow public read access" ON founder_secondary_missions FOR SELECT USING (true);


    -- Populate initial configuration data
    INSERT INTO config (key, value) VALUES
      ('totalTarget', '200000'),
      ('totalMonths', '6'),
      ('sprintStartMonth', '7'),
      ('sprintStartYear', '2025');

    -- Populate initial founder data (without passwords)
    INSERT INTO founders (id, name, target, access_key) VALUES
      (1, 'Tilman', 30000, 'placeholder'),
      (2, 'Simon', 100000, 'placeholder'),
      (3, 'Jan', 70000, 'placeholder');
      
    -- Populate the new mission
    INSERT INTO secondary_missions (id, name, description, target_arr, target_customers) VALUES
      (1, 'Echodeck Customer Acquisition', '4+ new paying customers for Echodeck with 100,000€ ARR', 100000, 4);

    -- Assign shares to founders for the new mission
    -- Founder IDs from above: Tilman=1, Jan=3
    INSERT INTO founder_secondary_missions (mission_id, founder_id, share_percentage) VALUES
      (1, 1, 70), -- 70% to Tilman
      (1, 3, 30); -- 30% to Jan
    ```
    *   Click the green **"RUN"** button. If it says "Success. No rows returned," it worked perfectly.
    
    ---
    ### For Existing Setups: Update Schema

    If you have already set up your database, run the SQL commands below in the SQL Editor to add the new tables and data without losing anything.

    ```sql
    -- Add description to revenue table if you haven't already
    ALTER TABLE revenue ADD COLUMN IF NOT EXISTS description TEXT;
    
    -- Add new tracking columns to revenue table
    ALTER TABLE revenue ADD COLUMN IF NOT EXISTS source TEXT NOT NULL DEFAULT 'Heuristiq';
    ALTER TABLE revenue ADD COLUMN IF NOT EXISTS is_new_customer BOOLEAN NOT NULL DEFAULT false;

    -- Add new tables for secondary missions if they don't exist
    CREATE TABLE IF NOT EXISTS secondary_missions (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      name TEXT NOT NULL,
      description TEXT NOT NULL
    );

    CREATE TABLE IF NOT EXISTS founder_secondary_missions (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      founder_id BIGINT REFERENCES founders(id) ON DELETE CASCADE,
      mission_id BIGINT REFERENCES secondary_missions(id) ON DELETE CASCADE,
      share_percentage INT NOT NULL
    );
    
    -- Add target columns to secondary_missions table
    ALTER TABLE secondary_missions ADD COLUMN IF NOT EXISTS target_arr INT;
    ALTER TABLE secondary_missions ADD COLUMN IF NOT EXISTS target_customers INT;

    -- Enable security and create policies if needed
    ALTER TABLE secondary_missions ENABLE ROW LEVEL SECURITY;
    ALTER TABLE founder_secondary_missions ENABLE ROW LEVEL SECURITY;
    DO $$
    BEGIN
      IF NOT EXISTS (SELECT 1 FROM pg_policy WHERE polname = 'Allow public read access' AND polrelid = 'secondary_missions'::regclass) THEN
        CREATE POLICY "Allow public read access" ON secondary_missions FOR SELECT USING (true);
      END IF;
      IF NOT EXISTS (SELECT 1 FROM pg_policy WHERE polname = 'Allow public read access' AND polrelid = 'founder_secondary_missions'::regclass) THEN
        CREATE POLICY "Allow public read access" ON founder_secondary_missions FOR SELECT USING (true);
      END IF;
    END;
    $$;

    -- Add a unique constraint for the ON CONFLICT clause to work.
    -- This ensures a founder is assigned to a mission only once.
    -- The script checks if the constraint already exists to prevent errors on re-runs.
    DO $$
    BEGIN
      IF NOT EXISTS (
        SELECT 1 FROM pg_constraint
        WHERE conname = 'founder_secondary_missions_mission_id_founder_id_key'
        AND conrelid = 'founder_secondary_missions'::regclass
      ) THEN
        ALTER TABLE founder_secondary_missions
        ADD CONSTRAINT founder_secondary_missions_mission_id_founder_id_key UNIQUE (mission_id, founder_id);
      END IF;
    END;
    $$;


    -- Upsert the mission data to avoid duplicates
    INSERT INTO secondary_missions (id, name, description, target_arr, target_customers)
    VALUES (1, 'Echodeck Customer Acquisition', '4+ new paying customers for Echodeck with 100,000€ ARR', 100000, 4)
    ON CONFLICT (id) DO UPDATE 
    SET name = EXCLUDED.name,
        description = EXCLUDED.description,
        target_arr = EXCLUDED.target_arr,
        target_customers = EXCLUDED.target_customers;

    -- Upsert the mission assignments
    INSERT INTO founder_secondary_missions (mission_id, founder_id, share_percentage)
    VALUES (1, 1, 70), (1, 3, 30)
    ON CONFLICT (mission_id, founder_id) DO UPDATE 
    SET share_percentage = EXCLUDED.share_percentage;
    ```
    ---

4.  **Set Founder Passwords (IMPORTANT):**
    *   In the left menu, click the **Table Editor** icon (looks like a spreadsheet).
    *   Click on the **`founders`** table.
    *   You will see your founders listed. For each founder, double-click the cell in the **`access_key`** column.
    *   Replace `placeholder` with a strong, unique password for that founder. Press Enter to save. Do this for all founders.

5.  **Get Your API Keys:**
    *   In the left menu, click the **gear icon** for "Project Settings", then click **"API"**.
    *   Find the **Project URL** and the **Project API Key** (use the `anon` `public` one).
    *   **Keep this browser tab open.** You'll need these in the final step.

### Step 2: Store Your Code on GitHub

1.  **Download the App:** Download the app files from this page.
2.  **Create a GitHub Account:** If you don't have one, sign up for free at [github.com](https://github.com).
3.  **Create a Repository:** Create a new, public repository (e.g., `mission-control-dashboard`).
4.  **Upload Files:** On the new repository page, click **"uploading an existing file"**. Drag and drop **all files and folders** from your downloaded app folder into the browser. Click **"Commit changes"**.

### Step 3: Deploy with Vercel

1.  **Create a Vercel Account:** Go to [vercel.com](https://vercel.com) and sign up with your **GitHub account**.
2.  **Import Your Project:** On your dashboard, click **"Add New... -> Project"**. Find your new GitHub repository and click **"Import"**.
3.  **Configure Environment Variables:**
    *   Vercel will auto-detect the project settings. You don't need to change anything.
    *   Expand the **"Environment Variables"** section.
    *   Add two variables, copying the values from the Supabase tab you kept open:
        *   **Name:** `VITE_SUPABASE_URL` | **Value:** (Paste your Project URL from Supabase)
        *   **Name:** `VITE_SUPABASE_ANON_KEY` | **Value:** (Paste your `anon` public key from Supabase)
    *   Click the **"Deploy"** button.

After a minute, Vercel will show you a success page. Click the URL or the screenshot to visit your live, secure dashboard!

---

## Slack Integration Setup (Optional)

Follow these steps to enable one-click progress updates to a Slack channel.

### Step 1: Create a Slack App

1.  **Go to Slack API:** Navigate to [api.slack.com/apps](https://api.slack.com/apps) and click **"Create New App"**.
2.  **Choose "From scratch"**: Give your app a name (e.g., "Mission Control Bot") and select the workspace you want to post to. Click **"Create App"**.
3.  **Add Permissions (Scopes):**
    *   From the app's settings page, go to **"OAuth & Permissions"** in the sidebar.
    *   Scroll down to the **"Scopes"** section. Under "Bot Token Scopes," click **"Add an OAuth Scope"**.
    *   Type and select `chat:write`. This allows the app to post messages.
4.  **Install App to Workspace:**
    *   Scroll back to the top of the "OAuth & Permissions" page and click **"Install to Workspace"**.
    *   Follow the prompts to authorize the app.
5.  **Copy Your Bot Token:**
    *   After installation, you will be redirected back. Copy the **"Bot User OAuth Token"**. It starts with `xoxb-`.
    *   **Keep this token safe. It is a secret.**

### Step 2: Add App to Your Channel

Go to the Slack channel where you want to receive updates (e.g., `#general`), type `/`, and search for "Add apps". Find and add the "Mission Control Bot" you just created.

### Step 3: Configure Vercel Environment Variables

1.  **Go to Vercel:** Open your project settings in Vercel.
2.  **Navigate to Environment Variables:** In the project settings, click on **"Environment Variables"**.
3.  **Add the Slack Token:**
    *   **Name:** `SLACK_BOT_TOKEN`
    *   **Value:** (Paste the `xoxb-` token you copied from Slack)
4.  **Add the App URL:**
    *   **Name:** `VITE_APP_URL`
    *   **Value:** (Paste the full URL of your Vercel deployment, e.g., `https://your-project-name.vercel.app`)
5.  **Save** the variables.

### Step 4: Re-deploy in Vercel

1.  Go to the **"Deployments"** tab for your project in Vercel.
2.  Find the latest deployment, click the "..." menu on the right, and choose **"Redeploy"**.
3.  Ensure the "Use existing Build Cache" option is **unchecked** to make sure it picks up the new code and environment variables correctly.
4.  Click **"Redeploy"**.

Once the new deployment is live, the "Post to Slack" button on the Team Dashboard will be active.

---

## Local Development (Optional)

If you want to run the app on your own computer:

1.  **Prerequisites:** Install [Node.js](https://nodejs.org/) and the [Vercel CLI](https://vercel.com/docs/cli) (`npm i -g vercel`).
2.  **Clone the Repository:** Download the code from GitHub.
3.  **Install Dependencies:** Open a terminal in the project folder and run `npm install`.
4.  **Create Environment File:**
    *   Create a file named `.env` in the root of the project.
    *   Add your variables to it like this:
        ```
        VITE_SUPABASE_URL="your-supabase-url"
        VITE_SUPABASE_ANON_KEY="your-supabase-anon-key"
        SLACK_BOT_TOKEN="your-xoxb-slack-token"
        VITE_APP_URL="http://localhost:5173" 
        ```
5.  **Run the App:** In your terminal, run `vercel dev`. This command runs both the Vite dev server and the Vercel serverless functions locally. It will give you a local URL to open.
